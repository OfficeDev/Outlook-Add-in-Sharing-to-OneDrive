---
page_type: sample
products:
- office-outlook
- office-onedrive
- office-365
languages:
- javascript
extensions:
  contentType: samples
  technologies:
  - Add-ins
  createdDate: 3/24/2016 9:32:55 AM
---
# <a name="microsoft-outlook-add-in-sharing-to-onedrive"></a>Надстройка Microsoft Outlook для предоставления общего доступа к файлам в OneDrive

Теперь пользователи могут делиться файлами, хранящимися в OneDrive, непосредственно из надстройки Outlook. В этом примере показано, как использовать API JavaScript для Office и API OneDrive для создания надстройки Microsoft Outlook, которая показывает, у каких получателей электронной почты есть разрешение на просмотр ссылки на OneDrive в тексте сообщения. Если у некоторых получателей такого разрешения нет, пользователь может предоставить его выбранным получателям.

С помощью API `shares` OneDrive можно программным способом получать разрешения для элемента с помощью ссылки на элемент. Предоставить URL-адрес получателям сообщения можно с помощью `shares` и API `action.invite`.


## <a name="table-of-contents"></a>Содержание

* [Необходимые компоненты](#prerequisites)
* [Настройка проекта](#configure-the-project)
* [Запуск проекта](#run-the-project)
* [Разбор кода](#understand-the-code)
* [Вопросы и комментарии](#questions-and-comments)
* [Дополнительные ресурсы](#additional-resources)

## <a name="prerequisites"></a>Необходимые компоненты

Для этого примера требуются следующие компоненты:

* Visual Studio 2015. Если у вас нет Visual Studio 2015, вы можете бесплатно установить [Visual Studio Community 2015](http://aka.ms/vscommunity2015). 
* [Инструменты разработчика Microsoft Office для Visual Studio 2015](http://aka.ms/officedevtoolsforvs2015).
* [Инструменты разработчика Microsoft Office для Visual Studio 2015 (предварительная версия)](http://www.microsoft.com/en-us/download/details.aspx?id=49972). Обратите внимание, что необходимо установить как базовую, так и предварительную версию Инструментов разработчика Microsoft Office для Visual Studio 2015.
* Outlook 2016.
* Компьютер с Exchange и по крайней мере одной учетной записью электронной почты или учетной записью Office 365. Если у вас нет какой-либо из этих учетных записей, вы можете [принять участие в программе для разработчиков Office 365 и получить бесплатную подписку на Office 365 сроком на 1 год](https://aka.ms/devprogramsignup).
* Личная учетная запись OneDrive. Она отличается от учетной записи Exchange.
* Браузер Internet Explorer 9 или более поздней версии. Он должен быть установлен, но может не быть браузером по умолчанию. Для поддержки надстроек клиент Office в качестве ведущего приложения задействует компоненты браузера, которые входят в состав Internet Explorer 9 и более поздней версии.

Примечание. В настоящее время этот пример подходит только для службы OneDrive, которая используется на домашних компьютерах. 

## <a name="configure-the-project"></a>Настройка проекта

1. Получите токен с сайта разработчика решений для OneDrive. Для этого откройте [страницу проверки подлинности OneDrive](https://dev.onedrive.com/auth/msa_oauth.htm) и выполните вход, а затем нажмите кнопку **Get Token** (Получить токен). Скопируйте токен, представленный после фразы _Authorization: bearer_ (Проверка подлинности: носитель), и сохраните его в текстовом файле. Этот токен действителен в течение часа и предоставляет вам доступ на чтение и запись к файлам OneDrive пользователя, выполнившего вход. Вам нужно будет войти в свое личное хранилище OneDrive.
2. Откройте файл решения **OutlookAddinOneDriveSharing.sln** и вставьте токен в файл `\app\authentication.config.js`, как показано ниже.
```
TOKEN = '<your_token>';
```
3. В **обозревателе решений** выберите проект **OutlookAddinOneDriveSharing**, а затем в окне **Свойства** измените элемент **Действие при запуске** на **Настольный клиент Office**.

4. Щелкните правой кнопкой мыши проект **OutlookAddinOneDriveSharing** и выберите команду **Назначить запускаемые проекты**.
5. Закройте клиент Outlook для настольных ПК.

## <a name="run-the-project"></a>Запуск проекта

Нажмите клавишу **F5**, чтобы запустить проект. Вам будет предложено ввести электронный адрес и пароль для запуска Outlook. Введите свой электронный адрес и пароль для _Exchange_. **Примечание.** Они могут отличаться от электронного адреса и пароля для личной учетной записи OneDrive. 

Когда запустится клиент Outlook для настольных ПК, нажмите кнопку **Создать сообщение**, чтобы написать новое сообщение.

**Важно!** Если вам не было предложено установить сертификат разработки для IIS Express, последовательно выберите элементы **Панель управления**, **Программы и компоненты** и **IIS Express**. Щелкните правой кнопкой мыши и выберите пункт **Восстановить**. Перезапустите Visual Studio и откройте файл OutlookAddinOneDriveSharing.sln.

В этом примере используются [команды надстроек](https://msdn.microsoft.com/EN-US/library/office/mt267547.aspx), поэтому для запуска надстройки нажмите кнопку на ленте, указанную ниже.

![Кнопка проверки доступа на ленте](/readme-images/commandbutton.PNG)

Отобразится область задач со списком получателей. Список разделен на две части. В одной из них указаны получатели с разрешением на просмотр ссылки, в другой — получатели без этого разрешения. **Примечание.** Каждый раз, когда вы добавляете или удаляете получателей либо редактируете ссылку, нажимайте эту кнопку заново, чтобы обновить список. 

Чтобы получить ссылку на OneDrive, войдите в учетную запись OneDrive на сайте www.onedrive.com и выберите один из своих файлов. Скопируйте ссылку на этот файл и вставьте ее в текст сообщения.

## <a name="understand-the-code"></a>Разбор кода

* В файле `app.js` создается глобальный объект получателей с помощью метода `Office.context.mail.item.getAsync` для считывания получателей сообщения. Ссылки считываются аналогичным образом (но с помощью метода `Office.context.mail.item.body.getAsync`).
* Файл `onedrive.share.service.js` — объект, позволяющий обрабатывать запросы для API OneDrive. Этот объект включает следующее:
    - Свойство для использования ссылок.
    - Метод для отправки запросов конечной точке API OneDrive и использования API предоставления общего доступа и разрешений.
    - Объект пользовательского интерфейса для отображения надстройки в области задач.
* Файл `render.controller.js` — объект для управления отображением в области задач. 

## <a name="remarks"></a>Замечания

* В этом примере проверяется только первая ссылка в тексте сообщения.
* Чтобы получить токен, необходимо использовать личную учетную запись OneDrive.
* Если вы используете учетную запись Outlook в качестве личной учетной записи OneDrive и она еще не перенесена в Office 365, то общий доступ может не работать. Чтобы проверить, перенесена ли учетная запись, войдите в Outlook.com. Если в левом верхнем углу написано Outlook.com, то учетная запись не перенесена.

## <a name="questions-and-comments"></a>Вопросы и комментарии

Мы будем рады получить ваши отзывы о примере *надстройки Outlook для предоставления общего доступа к файлам в OneDrive*. Своими мыслями можете поделиться на вкладке *Issues* (Проблемы) этого репозитория. Общие вопросы о разработке решений для Office 365 следует задавать на сайте [Stack Overflow](http://stackoverflow.com/questions/tagged/Office365+API). Помечайте свои вопросы тегами [Office365] и [API].

## <a name="additional-resources"></a>Дополнительные ресурсы

* [Документация по API-интерфейсам Office 365](http://msdn.microsoft.com/office/office365/howto/platform-development-overview)
* [Средства для интеграции API-интерфейсов Microsoft Office 365](https://visualstudiogallery.msdn.microsoft.com/a15b85e6-69a7-4fdf-adda-a38066bb5155)
* [Центр разработчика Office](http://dev.office.com/)
* [Проекты API Office 365 и примеры кода для начинающих](http://msdn.microsoft.com/en-us/office/office365/howto/starter-projects-and-code-samples)
* [Центр по разработке для OneDrive](http://dev.onedrive.com)
* [Центр по разработке для Outlook](http://dev.outlook.com)

## <a name="copyright"></a>Авторское право
(c) Корпорация Майкрософт (Microsoft Corporation), 2016. Все права защищены.



Этот проект соответствует [правилам поведения Майкрософт, касающимся обращения с открытым кодом](https://opensource.microsoft.com/codeofconduct/). Дополнительную информацию см. в разделе [часто задаваемых вопросов по правилам поведения](https://opensource.microsoft.com/codeofconduct/faq/). Если у вас возникли вопросы или замечания, напишите нам по адресу [opencode@microsoft.com](mailto:opencode@microsoft.com).
